<project name="CPBuildNUmber" default="" basedir=".">
	<description>Targets to run cp analysis</description>

	<property name="BuildNumFile" value="${WORKSPACE}/BuildNum.txt"/>

	<target name="extractBuildNumber" description="Extract build number from build_num file">
		<exec executable="/bin/sh" failonerror="true" >
			<arg value="-c" />
			<arg value="egrep -m 1 &apos;BUILD_NUM\s*=\s*\d*&apos; ${WORKSPACE}/server/src/common/include/make/build_num | sed &apos;s/BUILD_NUM=/BuildNum=/&apos; &gt; ${BuildNumFile}"/>
		</exec>
		<exec executable="/bin/sh" failonerror="true" >
			<arg value="-c" />
			<arg value="egrep -m 1 &apos;BUILD_NUM\s*=\s*\d*&apos; ${WORKSPACE}/server/src/common/include/make/build_num | sed &apos;s/BUILD_NUM=/NextBuildNum=/&apos; &gt;&gt; ${BuildNumFile}"/>
		</exec>

		<loadproperties>
			<file file="${BuildNumFile}"/>
		</loadproperties>


		<propertyfile file="${BuildNumFile}">
			<entry key="NextBuildNum" type="int" operation="+" value="1"/>
		</propertyfile>	
	</target>
	
</project>

